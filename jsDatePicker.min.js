"use strict";function jsDatePicker(a){return this.options={lang:"EN",currentDate:null,monthLabels:[],dayLabels:[],todayLabel:"",container:null,dtContainer:null,dtContainerId:null,dtTableContainer:null,dtTableHeadContainer:null,dtTableBodyContainer:null,dtTableFootContainer:null,dtHourContainer:null,dtPreviousMonth:null,dtToday:null,dtNextMonth:null,dtSelectMonth:null,dtSelectYear:null,currentMonth:null,currentYear:null,selectedDayContainer:null,selectedDay:null,selectedMonth:null,selectedYear:null,yearMin:100,yearMax:5,isInput:!1,isShow:!1,closeOnSelect:!1,clickOnDiv:!1,disabledItems:{},timepicker:!1,minHour:0,maxHour:23,useTimeHalf:!1,useTimeQuarter:!1,selectedHourContainer:null,selectedHour:null,onChange:null},this.init(a),this.options.isInput||this.generateStructure(),this}jsDatePicker.prototype.I18N={EN:{monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"],dayLabels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],todayLabel:"Today"},FR:{monthLabels:["Janvier","F\xe9vrier","Mars","Avril","Mai","Juin","Juillet","Ao\xfbt","Septembre","Octobre","Novembre","D\xe9cembre"],dayLabels:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],todayLabel:"Aujourd'hui"}},jsDatePicker.prototype.init=function(a){var b=this;for(var c in a)b.options.hasOwnProperty(c)&&(b.options[c]=a[c]);return b.options.currentMonth||(b.options.currentMonth=(new Date).getMonth()),b.options.currentYear||(b.options.currentYear=(new Date).getFullYear()),b.options.currentDate||(b.options.currentDate=new Date),b.useTime()===!0&&(b.options.container.setAttribute("maxlength",18),b.options.currentHour||(b.options.currentHour=b.options.currentDate.getHours(),parseInt(b.options.currentHour)<10&&(b.options.currentHour="0"+b.options.currentHour)),b.options.currentMinutes||(b.options.currentMinutes=b.options.currentDate.getMinutes(),parseInt(b.options.currentMinutes)<10&&(b.options.currentMinutes="0"+b.options.currentMinutes))),0===b.options.monthLabels.length&&(b.options.monthLabels=b.I18N[b.options.lang].monthLabels),0===b.options.dayLabels.length&&(b.options.dayLabels=b.I18N[b.options.lang].dayLabels),0===b.options.todayLabel.length&&(b.options.todayLabel=b.I18N[b.options.lang].todayLabel),"INPUT"===b.options.container.nodeName&&(b.options.isInput=!0,b.prepareInputValue(b.options.container.value),b.bindInput()),this},jsDatePicker.prototype.getCurrentDate=function(){var a=this;return a.options.currentDate&&(a.options.currentDate=new Date),a.options.currentDate},jsDatePicker.prototype.getCurrentYear=function(){return parseInt(this.options.currentYear)},jsDatePicker.prototype.getCurrentMonth=function(){return parseInt(this.options.currentMonth)},jsDatePicker.prototype.getCurrentMonthLabel=function(){return this.options.monthLabels[this.getCurrentMonth()]},jsDatePicker.prototype.getMonthLabel=function(a){return a||(a=0),this.options.monthLabels[a]},jsDatePicker.prototype.getDayLabel=function(a){return this.options.dayLabels[a]?this.options.dayLabels[a]:""},jsDatePicker.prototype.getSelectedDayContainer=function(){return this.options.selectedDayContainer},jsDatePicker.prototype.getSelectedHourContainer=function(){return this.options.selectedHourContainer},jsDatePicker.prototype.getSelectedDay=function(){return parseInt(this.options.selectedDay)},jsDatePicker.prototype.getSelectedMonth=function(){return parseInt(this.options.selectedMonth)},jsDatePicker.prototype.getSelectedYear=function(){return this.options.selectedYear},jsDatePicker.prototype.generateSelectMonth=function(){this.options.dtSelectMonth=document.createElement("select"),this.options.dtSelectMonth.className+="dt-select-month";for(var a="",b=0;b<this.options.monthLabels.length;b++)a+='<option value="'+b+'" '+(b===this.getCurrentMonth()?'selected="selected"':"")+">"+this.getMonthLabel(b)+"</option>";this.options.dtSelectMonth.innerHTML=a,this.bindSelectMonth()},jsDatePicker.prototype.changeSelectMonth=function(){this.options.dtSelectMonth.value=parseInt(this.getCurrentMonth())},jsDatePicker.prototype.generateSelectYear=function(){this.options.dtSelectYear=document.createElement("select"),this.options.dtSelectYear.className+="dt-select-year";for(var a="",b=parseInt(this.getCurrentYear())-this.options.yearMin;b<=parseInt(this.getCurrentYear())+this.options.yearMax;b++)a+='<option value="'+b+'" '+(b===parseInt(this.getCurrentYear())?'selected="selected"':"")+">"+b+"</option>";this.options.dtSelectYear.innerHTML=a,this.bindSelectYear()},jsDatePicker.prototype.changeSelectYear=function(){this.options.dtSelectYear.value=this.getCurrentYear()},jsDatePicker.prototype.generateStructure=function(){var a=document.getElementById(this.options.dtContainerId);if(a&&a.remove(),this.options.dtContainer=document.createElement("div"),this.options.dtContainerId="dt-"+Math.random().toString(36).substr(2,9),this.options.dtContainer.setAttribute("id",this.options.dtContainerId),this.options.dtContainer.className+=" dt-container",this.options.dtTableContainer=document.createElement("table"),this.options.dtTableContainer.className+="dt-table",this.options.dtTableHeadContainer=document.createElement("thead"),this.options.dtTableBodyContainer=document.createElement("tbody"),this.options.dtTableFootContainer=document.createElement("tfoot"),this.options.dtTableContainer.appendChild(this.options.dtTableHeadContainer),this.options.dtTableContainer.appendChild(this.options.dtTableBodyContainer),this.options.dtTableContainer.appendChild(this.options.dtTableFootContainer),this.options.dtContainer.appendChild(this.options.dtTableContainer),this.generateHeader(),this.generateBody(),this.generateFooter(),this.options.isInput){this.options.dtContainer.style.position="absolute";var b=this.getPosition(this.options.container);this.options.dtContainer.style.zIndex="999",this.options.dtContainer.style.left=b[0]+"px",this.options.dtContainer.style.top=b[1]+this.options.container.clientHeight+5+"px",document.body.appendChild(this.options.dtContainer)}else this.options.container.innerHTML="",this.options.container.appendChild(this.options.dtContainer);this.bindScroll()},jsDatePicker.prototype.generateHeader=function(){var a=document.createElement("tr"),b=document.createElement("th");this.options.dtPreviousMonth=document.createElement("div"),this.options.dtPreviousMonth.className="dt-nav dt-previous-month",this.options.dtPreviousMonth.innerHTML="<",b.appendChild(this.options.dtPreviousMonth),a.appendChild(b),this.generateSelectMonth(),b=document.createElement("th"),b.setAttribute("colspan",5),b.appendChild(this.options.dtSelectMonth),this.generateSelectYear(),b.appendChild(this.options.dtSelectYear),a.appendChild(b),b=document.createElement("th"),this.options.dtNextMonth=document.createElement("div"),this.options.dtNextMonth.className="dt-nav dt-next-month",this.options.dtNextMonth.innerHTML=">",b.appendChild(this.options.dtNextMonth),a.appendChild(b),this.options.dtTableHeadContainer.appendChild(a),this.bindNextMonth(),this.bindPreviousMonth()},jsDatePicker.prototype.generateBody=function(){var b,a=document.createElement("tr");a.className="dt-header";var c="";for(b=0;6>=b;b++){var d=0;d=6>b?b+1:0,c+='<td class="dt-header-day">',c+=this.getDayLabel(d),c+="</td>"}if(a.innerHTML=c,this.useTime()===!0){this.options.dtHourContainer=document.createElement("td"),this.options.dtHourContainer.setAttribute("rowspan",6),this.options.dtHourContainer.className="dt-hour-container",c="<ul>";var e="";for(b=this.options.minHour;b<=this.options.maxHour;b++)if(e=(b>9?"":"0")+b+":00",c+='<li class="dt-hour '+(this.options.selectedHour!==e?"":"dt-hour-selected")+'" data-value="'+e+'">'+(b>9?"":"0")+b+":00</li>",this.options.useTimeQuarter)for(var f=15;45>=f;f+=15)e=(b>9?"":"0")+b+":"+f,c+='<li class="dt-hour '+(this.options.selectedHour!==e?"":"dt-hour-selected")+'" data-value="'+e+'">'+(b>9?"":"0")+b+":"+f+"</li>";else this.options.useTimeHalf&&(e=(b>9?"":"0")+b+":30",c+='<li class="dt-hour '+(this.options.selectedHour!==e?"":"dt-hour-selected")+'" data-value="'+e+'">'+(b>9?"":"0")+b+":30</li>");c+="</ul>",this.options.dtHourContainer.innerHTML=c,a.appendChild(this.options.dtHourContainer)}this.options.dtTableBodyContainer.appendChild(a),this.useTime()===!0&&(this.initTimePosition(),this.bindTime()),this.generateDayHTML()},jsDatePicker.prototype.initTimePosition=function(){if(this.options.selectedHour){var a=this.options.dtHourContainer.querySelector('li[data-value="'+this.options.selectedHour+'"]');if(a){var b=this;setTimeout(function(){b.options.dtHourContainer.querySelector("ul").scrollTop=a.offsetTop},1)}}},jsDatePicker.prototype.setTimeSelected=function(){for(var a=this.options.dtHourContainer.querySelectorAll("li.dt-hour-selected"),b=0;b<a.length;b++)a[b].className=a[b].className.replace(" dt-hour-selected","");if(this.options.selectedHour){var c=this.options.dtHourContainer.querySelector('li[data-value="'+this.options.selectedHour+'"]');c&&(c.className+=" dt-hour-selected",this.initTimePosition())}},jsDatePicker.prototype.generateFooter=function(){var a=document.createElement("tr"),b=document.createElement("td");b.setAttribute("colspan",7),this.options.dtToday=document.createElement("div"),this.options.dtToday.className="dt-today",this.options.dtToday.innerHTML=this.options.todayLabel,b.appendChild(this.options.dtToday),a.appendChild(b),this.options.dtTableFootContainer.appendChild(a),this.bindToday()},jsDatePicker.prototype.generateDayHTML=function(){var a=this,b=new Date(a.getCurrentYear(),a.getCurrentMonth(),1),c=b.getDay(),d=new Date(a.getCurrentYear(),a.getCurrentMonth()+1,0).getDate();a.changeSelectMonth(),a.changeSelectYear();var m,e=a.getCurrentDate(),f=e.getDate(),g=e.getMonth(),h=!1,i=1,j=!1,k=null,l=null,n=a.options.dtTableBodyContainer.querySelectorAll(".dt-tr-day");if(n)for(m=0;m<n.length;m++)n[m].remove();for(m=0;9>m;m++){k=document.createElement("tr"),k.className="dt-tr-day";for(var o=0;6>=o;o++){var p=o,q=o+1,r="enabled";a.isDisabledItem(q,i)&&(r="disabled"),h=!1,i===f&&a.getCurrentMonth()===g&&(h=!0);var s=!1;a.getSelectedDay()===i&&a.getSelectedMonth()===a.getCurrentMonth()&&a.getSelectedYear()===a.getCurrentYear()&&(s=!0),j=!1,d>=i&&(m>0||0!=c&&q>=c||0==c&&6==p)&&(j=!0),l=document.createElement("td"),l.className=r+" "+(j?"dt-day":"")+" "+(h?"dt-current":"")+" "+(s?"dt-selected":""),l.setAttribute("data-day",i),j&&(l.innerHTML="<span>"+i+"</span>",i++),s&&(a.options.selectedDayContainer=l),k.appendChild(l)}if(a.options.dtTableBodyContainer.appendChild(k),i>d)break}a.bindDay()},jsDatePicker.prototype.getPosition=function(a){for(var b=0,c=0,d=a;void 0!==d.offsetParent&&null!==d.offsetParent;)b+=d.offsetLeft+(null!==d.clientLeft?d.clientLeft:0),c+=d.offsetTop+(null!==d.clientTop?d.clientTop:0),d=d.offsetParent;return[b,c]},jsDatePicker.prototype.bindNextMonth=function(){var a=this,b=a.options.dtContainer.querySelector(".dt-next-month");b.addEventListener("click",function(b){b.preventDefault(),a.clickOnNextMonth()},!1)},jsDatePicker.prototype.clickOnNextMonth=function(){var a=this;a.getCurrentMonth()<11?a.options.currentMonth++:(a.options.currentMonth=0,a.options.currentYear++),a.generateDayHTML()},jsDatePicker.prototype.bindPreviousMonth=function(){var a=this,b=a.options.dtContainer.querySelector(".dt-previous-month");b.addEventListener("click",function(b){b.preventDefault(),a.clickOnPreviousMonth()},!1)},jsDatePicker.prototype.clickOnPreviousMonth=function(){var a=this;a.getCurrentMonth()>0?a.options.currentMonth--:(a.options.currentMonth=11,a.options.currentYear--),a.generateDayHTML()},jsDatePicker.prototype.bindSelectMonth=function(){var a=this;this.options.dtSelectMonth.addEventListener("change",function(b){b.preventDefault(),a.onChangeSelectMonth(this)},!1)},jsDatePicker.prototype.onChangeSelectMonth=function(a){this.options.currentMonth=parseInt(a.value),this.generateDayHTML()},jsDatePicker.prototype.bindSelectYear=function(){var a=this;this.options.dtSelectYear.addEventListener("change",function(b){b.preventDefault(),a.onChangeSelectYear(this)},!1)},jsDatePicker.prototype.onChangeSelectYear=function(a){this.options.currentYear=a.value,this.generateDayHTML()},jsDatePicker.prototype.bindToday=function(){var a=this;this.options.dtToday.addEventListener("click",function(b){b.preventDefault(),a.clickOnToday()},!1)},jsDatePicker.prototype.bindScroll=function(){var a=this;a.options.dtTableBodyContainer.addEventListener("mousewheel",function(b){for(var c=b.target;c&&"TBODY"!==c.nodeName;){if(c.className.indexOf("dt-hour-container")>=0)return;c=c.parentNode}return b.stopImmediatePropagation(),b.preventDefault(),b.deltaY>0?a.clickOnNextMonth():a.clickOnPreviousMonth(),!1},!1)},jsDatePicker.prototype.useTime=function(){return this.options.timepicker},jsDatePicker.prototype.clickOnToday=function(){var a=this,b=new Date;a.options.currentMonth=b.getMonth(),a.options.currentYear=b.getFullYear(),a.useTime()===!0&&(a.options.currentHour=b.getHours(),a.options.currentMinutes=b.getMinutes()),a.generateDayHTML()},jsDatePicker.prototype.bindDay=function(){for(var a=this,b=a.options.dtTableBodyContainer.querySelectorAll(".dt-day.enabled"),c=function(b){b.stopImmediatePropagation(),b.preventDefault(),a.clickOnDay(this)},d=0,e=b.length;e>d;d++)b[d].addEventListener&&b[d].addEventListener("click",c,!1)},jsDatePicker.prototype.clickOnDay=function(a){var b=this,c=null;if(b.getSelectedDayContainer()){c=b.options.dtTableBodyContainer.querySelectorAll(".dt-selected");for(var d=0;d<c.length;d++)c[d].className=c[d].className.replace(" dt-selected","")}b.options.selectedDayContainer=a,b.options.selectedDay=a.getAttribute("data-day"),b.options.selectedMonth=parseInt(b.options.currentMonth),b.options.selectedYear=b.options.currentYear,b.options.selectedDayContainer.className+=" dt-selected",b.selectedDayToString(),b.options.onChange&&b.options.onChange(this.options.container),b.options.closeOnSelect&&!b.useTime()&&b.remove()},jsDatePicker.prototype.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)},jsDatePicker.prototype.clickOnHour=function(a){var b=this,c=null;c=b.options.dtHourContainer.querySelectorAll(".dt-hour-selected");for(var d=0;d<c.length;d++)c[d].className=c[d].className.replace(" dt-hour-selected","");b.options.selectedHourContainer=a,b.options.selectedHourContainer.className+=" dt-hour-selected",b.options.currentHour=b.options.selectedHourContainer.getAttribute("data-value").split(":")[0],b.options.currentMinutes=b.options.selectedHourContainer.getAttribute("data-value").split(":")[1],b.options.selectedHour=b.options.selectedHourContainer.getAttribute("data-value"),b.selectedDayToString(),b.options.onChange&&b.options.onChange(this.options.container),b.options.closeOnSelect&&b.remove()},jsDatePicker.prototype.bindTime=function(){for(var a=this,b=a.options.dtTableBodyContainer.querySelectorAll(".dt-hour"),c=function(b){b.preventDefault(),a.clickOnHour(this)},d=0;d<b.length;d++)b[d].addEventListener("click",c,!1)},jsDatePicker.prototype.selectedDayToString=function(){var a=this,b="",c="",d="",e="";return a.getSelectedDayContainer()&&a.getSelectedDayContainer().getAttribute?(b=parseInt(a.getSelectedDayContainer().getAttribute("data-day")),c=a.options.selectedMonth+1,d=a.getSelectedYear()):(b=a.getSelectedDay()||a.options.currentDate.getDate(),c=a.getSelectedMonth()?a.getSelectedMonth()+1:a.options.currentMonth,d=a.getSelectedYear()||a.options.currentYear),parseInt(b)<10&&(b="0"+b),10>c&&(c="0"+c),e=b+"/"+c+"/"+d,a.useTime()&&(e+=" - "+a.options.selectedHour),a.options.isInput&&(a.options.container.value=e),e},jsDatePicker.prototype.bindInput=function(){var a=this;a.options.container.addEventListener("focus",function(){a.options.isShow=!0,a.prepareInputValue(this.value),a.generateStructure()},!1),a.options.container.addEventListener("blur",function(){a.options.onChange&&a.options.onChange(a.options.container)}),a.options.container.addEventListener("keyup",function(){var b=a.options.container.value;a.prepareInputValue(b)&&(a.options.dtContainer?(a.generateDayHTML(),a.useTime()&&a.setTimeSelected()):a.generateStructure())}),document.addEventListener("mousedown",function(b){var c=b.target;for(a.options.clickOnDiv=!1;c&&!a.options.clickOnDiv;)(c.id===a.options.dtContainerId||c===a.options.container)&&(a.options.clickOnDiv=!0),c=c.parentNode;!a.options.clickOnDiv&&a.options.isShow&&a.remove()})},jsDatePicker.prototype.prepareInputValue=function(a){var b=this,c=a.split(" - "),d=c[0].split("/"),e=!1,f=!1;if(d.length>0&&(d[0]&&!isNaN(d[0])&&(b.options.selectedDay="00"!==d[0]?d[0]:(new Date).getDate(),e=!0),d[1]&&d[1]>0&&d[1]<=12&&!isNaN(d[1])&&("00"===d[1]&&(d[1]=(new Date).getMonth(),f=!0),b.options.selectedMonth=d[1]-1,b.options.currentMonth=parseInt(d[1])-1,e=!0),d[2]&&!isNaN(d[2]))){if("0000"===d[2]){var g=(new Date).getFullYear();d[2]=g,f=!0}b.options.selectedYear=d[2],b.options.currentYear=d[2],e=!0}if(b.useTime()===!0){if(c[1]){var h=c[1].split(":");b.options.currentHour=h[0],parseInt(b.options.currentHour)>23&&(b.options.currentHour=23),parseInt(b.options.currentHour)<0&&(b.options.currentHour=0),b.options.currentMinutes=h[1],parseInt(b.options.currentMinutes)>59&&(b.options.currentMinutes=59),parseInt(b.options.currentMinutes)<0&&(b.options.currentMinutes=0),e=!0}if(isNaN(b.options.currentHour)||isNaN(b.options.currentMinutes)){var i=new Date;b.options.currentHour=i.getHours(),b.options.currentMinutes=i.getMinutes(),e=!0}b.options.selectedHour=b.options.currentHour+":"+b.options.currentMinutes}return f&&(b.options.container.value=b.selectedDayToString()),e},jsDatePicker.prototype.isDisabledItem=function(a,b){var c=this,d=!1;if(a&&c.options.disabledItems.days&&(d=c.isDisabledDay(a)),!d&&c.options.disabledItems.dates&&b){var e=b+"/"+(c.getCurrentMonth()+1<10?"0":"")+(c.getCurrentMonth()+1)+"/"+c.getCurrentYear();d=c.isDisabledDate(e)}return d},jsDatePicker.prototype.isDisabledDay=function(a){var b=this;if(b.options.disabledItems.days.length>0){if(a=parseInt(a),0===a&&b.options.disabledItems.days.indexOf("sunday")>=0)return!0;if(1===a&&b.options.disabledItems.days.indexOf("monday")>=0)return!0;if(2===a&&b.options.disabledItems.days.indexOf("tuesday")>=0)return!0;if(3===a&&b.options.disabledItems.days.indexOf("wednesday")>=0)return!0;if(4===a&&b.options.disabledItems.days.indexOf("thursday")>=0)return!0;if(5===a&&b.options.disabledItems.days.indexOf("friday")>=0)return!0;if(6===a&&b.options.disabledItems.days.indexOf("saturday")>=0)return!0}return!1},jsDatePicker.prototype.isDisabledDate=function(a){var b=this;return b.options.disabledItems.dates.indexOf(a)>=0?!0:!1},jsDatePicker.prototype.remove=function(){var a=this;a.options.isShow=!1,a.options.dtContainer.remove(),a.options.dtContainer=null};