"use strict";function jsDatePicker(t){return this.options={lang:"EN",currentDate:null,monthLabels:[],dayLabels:[],todayLabel:"",container:null,dtContainer:null,dtContainerId:null,dtTableContainer:null,dtTableHeadContainer:null,dtTableBodyContainer:null,dtTableFootContainer:null,dtHourContainer:null,dtPreviousMonth:null,dtToday:null,dtNextMonth:null,dtSelectMonth:null,dtSelectYear:null,currentMonth:null,currentYear:null,selectedDayContainer:null,selectedDay:null,selectedMonth:null,selectedYear:null,yearMin:100,yearMax:5,isInput:!1,isShow:!1,closeOnSelect:!1,clickOnDiv:!1,disabledItems:{},timepicker:!1,minHour:0,maxHour:23,useTimeHalf:!1,useTimeQuarter:!1,selectedHourContainer:null,selectedHour:null,onChange:null},this.init(t),this.options.isInput||this.generateStructure(),this}jsDatePicker.prototype.I18N={EN:{monthLabels:["January","February","March","April","May","June","July","August","September","October","November","December"],dayLabels:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],todayLabel:"Today"},FR:{monthLabels:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayLabels:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"],todayLabel:"Aujourd'hui"}},jsDatePicker.prototype.init=function(t){var e=this;for(var n in t)e.options.hasOwnProperty(n)&&(e.options[n]=t[n]);return e.options.currentMonth||(e.options.currentMonth=(new Date).getMonth()),e.options.currentYear||(e.options.currentYear=(new Date).getFullYear()),e.options.currentDate||(e.options.currentDate=new Date),e.useTime()===!0&&(e.options.container.setAttribute("maxlength",18),e.options.currentHour||(e.options.currentHour=e.options.currentDate.getHours(),parseInt(e.options.currentHour)<10&&(e.options.currentHour="0"+e.options.currentHour)),e.options.currentMinutes||(e.options.currentMinutes=e.options.currentDate.getMinutes(),parseInt(e.options.currentMinutes)<10&&(e.options.currentMinutes="0"+e.options.currentMinutes))),0===e.options.monthLabels.length&&(e.options.monthLabels=e.I18N[e.options.lang].monthLabels),0===e.options.dayLabels.length&&(e.options.dayLabels=e.I18N[e.options.lang].dayLabels),0===e.options.todayLabel.length&&(e.options.todayLabel=e.I18N[e.options.lang].todayLabel),"INPUT"===e.options.container.nodeName&&(e.options.isInput=!0,e.prepareInputValue(e.options.container.value),e.bindInput()),this},jsDatePicker.prototype.getCurrentDate=function(){var t=this;return t.options.currentDate&&(t.options.currentDate=new Date),t.options.currentDate},jsDatePicker.prototype.getCurrentYear=function(){return parseInt(this.options.currentYear)},jsDatePicker.prototype.getCurrentMonth=function(){return parseInt(this.options.currentMonth)},jsDatePicker.prototype.getCurrentMonthLabel=function(){return this.options.monthLabels[this.getCurrentMonth()]},jsDatePicker.prototype.getMonthLabel=function(t){return t||(t=0),this.options.monthLabels[t]},jsDatePicker.prototype.getDayLabel=function(t){return this.options.dayLabels[t]?this.options.dayLabels[t]:""},jsDatePicker.prototype.getSelectedDayContainer=function(){return this.options.selectedDayContainer},jsDatePicker.prototype.getSelectedHourContainer=function(){return this.options.selectedHourContainer},jsDatePicker.prototype.getSelectedDay=function(){return parseInt(this.options.selectedDay)},jsDatePicker.prototype.getSelectedMonth=function(){return parseInt(this.options.selectedMonth)},jsDatePicker.prototype.getSelectedYear=function(){return this.options.selectedYear},jsDatePicker.prototype.generateSelectMonth=function(){this.options.dtSelectMonth=document.createElement("select"),this.options.dtSelectMonth.className+="dt-select-month";for(var t="",e=0;e<this.options.monthLabels.length;e++)t+='<option value="'+e+'" '+(e===this.getCurrentMonth()?'selected="selected"':"")+">"+this.getMonthLabel(e)+"</option>";this.options.dtSelectMonth.innerHTML=t,this.bindSelectMonth()},jsDatePicker.prototype.changeSelectMonth=function(){this.options.dtSelectMonth.value=parseInt(this.getCurrentMonth())},jsDatePicker.prototype.generateSelectYear=function(){this.options.dtSelectYear=document.createElement("select"),this.options.dtSelectYear.className+="dt-select-year";for(var t="",e=parseInt(this.getCurrentYear())-this.options.yearMin;e<=parseInt(this.getCurrentYear())+this.options.yearMax;e++)t+='<option value="'+e+'" '+(e===parseInt(this.getCurrentYear())?'selected="selected"':"")+">"+e+"</option>";this.options.dtSelectYear.innerHTML=t,this.bindSelectYear()},jsDatePicker.prototype.changeSelectYear=function(){this.options.dtSelectYear.value=this.getCurrentYear()},jsDatePicker.prototype.generateStructure=function(){var t=document.getElementById(this.options.dtContainerId);if(t&&t.remove(),this.options.dtContainer=document.createElement("div"),this.options.dtContainerId="dt-"+Math.random().toString(36).substr(2,9),this.options.dtContainer.setAttribute("id",this.options.dtContainerId),this.options.dtContainer.className+=" dt-container",this.options.dtTableContainer=document.createElement("table"),this.options.dtTableContainer.className+="dt-table",this.options.dtTableHeadContainer=document.createElement("thead"),this.options.dtTableBodyContainer=document.createElement("tbody"),this.options.dtTableFootContainer=document.createElement("tfoot"),this.options.dtTableContainer.appendChild(this.options.dtTableHeadContainer),this.options.dtTableContainer.appendChild(this.options.dtTableBodyContainer),this.options.dtTableContainer.appendChild(this.options.dtTableFootContainer),this.options.dtContainer.appendChild(this.options.dtTableContainer),this.generateHeader(),this.generateBody(),this.generateFooter(),this.options.isInput){this.options.dtContainer.style.position="absolute";var e=this.getPosition(this.options.container);this.options.dtContainer.style.zIndex="999",this.options.dtContainer.style.left=e[0]+"px",this.options.dtContainer.style.top=e[1]+this.options.container.clientHeight+5+"px",document.body.appendChild(this.options.dtContainer)}else this.options.container.innerHTML="",this.options.container.appendChild(this.options.dtContainer);this.bindScroll()},jsDatePicker.prototype.generateHeader=function(){var t=document.createElement("tr"),e=document.createElement("th");this.options.dtPreviousMonth=document.createElement("div"),this.options.dtPreviousMonth.className="dt-nav dt-previous-month",this.options.dtPreviousMonth.innerHTML="<",e.appendChild(this.options.dtPreviousMonth),t.appendChild(e),this.generateSelectMonth(),e=document.createElement("th"),e.setAttribute("colspan",5),e.appendChild(this.options.dtSelectMonth),this.generateSelectYear(),e.appendChild(this.options.dtSelectYear),t.appendChild(e),e=document.createElement("th"),this.options.dtNextMonth=document.createElement("div"),this.options.dtNextMonth.className="dt-nav dt-next-month",this.options.dtNextMonth.innerHTML=">",e.appendChild(this.options.dtNextMonth),t.appendChild(e),this.options.dtTableHeadContainer.appendChild(t),this.bindNextMonth(),this.bindPreviousMonth()},jsDatePicker.prototype.generateBody=function(){var t,e=document.createElement("tr");e.className="dt-header";var n="";for(t=0;6>=t;t++)n+='<td class="dt-header-day">',n+=this.getDayLabel(t),n+="</td>";if(e.innerHTML=n,this.useTime()===!0){this.options.dtHourContainer=document.createElement("td"),this.options.dtHourContainer.setAttribute("rowspan",6),this.options.dtHourContainer.className="dt-hour-container",n="<ul>";var o="";for(t=this.options.minHour;t<=this.options.maxHour;t++)if(o=(t>9?"":"0")+t+":00",n+='<li class="dt-hour '+(this.options.selectedHour!==o?"":"dt-hour-selected")+'" data-value="'+o+'">'+(t>9?"":"0")+t+":00</li>",this.options.useTimeQuarter)for(var i=15;45>=i;i+=15)o=(t>9?"":"0")+t+":"+i,n+='<li class="dt-hour '+(this.options.selectedHour!==o?"":"dt-hour-selected")+'" data-value="'+o+'">'+(t>9?"":"0")+t+":"+i+"</li>";else this.options.useTimeHalf&&(o=(t>9?"":"0")+t+":30",n+='<li class="dt-hour '+(this.options.selectedHour!==o?"":"dt-hour-selected")+'" data-value="'+o+'">'+(t>9?"":"0")+t+":30</li>");n+="</ul>",this.options.dtHourContainer.innerHTML=n,e.appendChild(this.options.dtHourContainer)}this.options.dtTableBodyContainer.appendChild(e),this.useTime()===!0&&(this.initTimePosition(),this.bindTime()),this.generateDayHTML()},jsDatePicker.prototype.initTimePosition=function(){if(this.options.selectedHour){var t=this.options.dtHourContainer.querySelector('li[data-value="'+this.options.selectedHour+'"]');if(t){var e=this;setTimeout(function(){e.options.dtHourContainer.querySelector("ul").scrollTop=t.offsetTop},1)}}},jsDatePicker.prototype.setTimeSelected=function(){for(var t=this.options.dtHourContainer.querySelectorAll("li.dt-hour-selected"),e=0;e<t.length;e++)t[e].className=t[e].className.replace(" dt-hour-selected","");if(this.options.selectedHour){var n=this.options.dtHourContainer.querySelector('li[data-value="'+this.options.selectedHour+'"]');n&&(n.className+=" dt-hour-selected",this.initTimePosition())}},jsDatePicker.prototype.generateFooter=function(){var t=document.createElement("tr"),e=document.createElement("td");e.setAttribute("colspan",7),this.options.dtToday=document.createElement("div"),this.options.dtToday.className="dt-today",this.options.dtToday.innerHTML=this.options.todayLabel,e.appendChild(this.options.dtToday),t.appendChild(e),this.options.dtTableFootContainer.appendChild(t),this.bindToday()},jsDatePicker.prototype.generateDayHTML=function(){var t=this,e=new Date(t.getCurrentYear(),t.getCurrentMonth(),1),n=e.getDay(),o=new Date(t.getCurrentYear(),t.getCurrentMonth()+1,0).getDate();t.changeSelectMonth(),t.changeSelectYear();var i,r=t.getCurrentDate(),s=r.getDate(),a=r.getMonth(),l=!1,d=1,c=!1,p=null,u=null,h=t.options.dtTableBodyContainer.querySelectorAll(".dt-tr-day");if(h)for(i=0;i<h.length;i++)h[i].remove();for(i=0;9>i;i++){p=document.createElement("tr"),p.className="dt-tr-day";for(var y=0;6>=y;y++){var m="enabled";t.isDisabledItem(y,d)&&(m="disabled"),l=!1,d===s&&t.getCurrentMonth()===a&&(l=!0);var f=!1;t.getSelectedDay()===d&&t.getSelectedMonth()===t.getCurrentMonth()&&t.getSelectedYear()===t.getCurrentYear()&&(f=!0),c=!1,o>=d&&(i>0||y>=n)&&(c=!0),u=document.createElement("td"),u.className=m+" "+(c?"dt-day":"")+" "+(l?"dt-current":"")+" "+(f?"dt-selected":""),u.setAttribute("data-day",d),c&&(u.innerHTML="<span>"+d+"</span>",d++),f&&(t.options.selectedDayContainer=u),p.appendChild(u)}if(d>o)break;t.options.dtTableBodyContainer.appendChild(p)}t.bindDay()},jsDatePicker.prototype.getPosition=function(t){for(var e=0,n=0,o=t;void 0!==o.offsetParent&&null!==o.offsetParent;)e+=o.offsetLeft+(null!==o.clientLeft?o.clientLeft:0),n+=o.offsetTop+(null!==o.clientTop?o.clientTop:0),o=o.offsetParent;return[e,n]},jsDatePicker.prototype.bindNextMonth=function(){var t=this,e=t.options.dtContainer.querySelector(".dt-next-month");e.addEventListener("click",function(e){e.preventDefault(),t.clickOnNextMonth()},!1)},jsDatePicker.prototype.clickOnNextMonth=function(){var t=this;t.getCurrentMonth()<11?t.options.currentMonth++:(t.options.currentMonth=0,t.options.currentYear++),t.generateDayHTML()},jsDatePicker.prototype.bindPreviousMonth=function(){var t=this,e=t.options.dtContainer.querySelector(".dt-previous-month");e.addEventListener("click",function(e){e.preventDefault(),t.clickOnPreviousMonth()},!1)},jsDatePicker.prototype.clickOnPreviousMonth=function(){var t=this;t.getCurrentMonth()>0?t.options.currentMonth--:(t.options.currentMonth=11,t.options.currentYear--),t.generateDayHTML()},jsDatePicker.prototype.bindSelectMonth=function(){var t=this;this.options.dtSelectMonth.addEventListener("change",function(e){e.preventDefault(),t.onChangeSelectMonth(this)},!1)},jsDatePicker.prototype.onChangeSelectMonth=function(t){this.options.currentMonth=parseInt(t.value),this.generateDayHTML()},jsDatePicker.prototype.bindSelectYear=function(){var t=this;this.options.dtSelectYear.addEventListener("change",function(e){e.preventDefault(),t.onChangeSelectYear(this)},!1)},jsDatePicker.prototype.onChangeSelectYear=function(t){this.options.currentYear=t.value,this.generateDayHTML()},jsDatePicker.prototype.bindToday=function(){var t=this;this.options.dtToday.addEventListener("click",function(e){e.preventDefault(),t.clickOnToday()},!1)},jsDatePicker.prototype.bindScroll=function(){var t=this;t.options.dtTableBodyContainer.addEventListener("mousewheel",function(e){for(var n=e.target;n&&"TBODY"!==n.nodeName;){if(n.className.indexOf("dt-hour-container")>=0)return;n=n.parentNode}return e.stopImmediatePropagation(),e.preventDefault(),e.deltaY>0?t.clickOnNextMonth():t.clickOnPreviousMonth(),!1},!1)},jsDatePicker.prototype.useTime=function(){return this.options.timepicker},jsDatePicker.prototype.clickOnToday=function(){var t=this,e=new Date;t.options.currentMonth=e.getMonth(),t.options.currentYear=e.getFullYear(),t.useTime()===!0&&(t.options.currentHour=e.getHours(),t.options.currentMinutes=e.getMinutes()),t.generateDayHTML()},jsDatePicker.prototype.bindDay=function(){for(var t=this,e=t.options.dtTableBodyContainer.querySelectorAll(".dt-day.enabled"),n=function(e){e.stopImmediatePropagation(),e.preventDefault(),t.clickOnDay(this)},o=0,i=e.length;i>o;o++)e[o].addEventListener&&e[o].addEventListener("click",n,!1)},jsDatePicker.prototype.clickOnDay=function(t){var e=this,n=null;if(e.getSelectedDayContainer()){n=e.options.dtTableBodyContainer.querySelectorAll(".dt-selected");for(var o=0;o<n.length;o++)n[o].className=n[o].className.replace(" dt-selected","")}e.options.selectedDayContainer=t,e.options.selectedDay=t.getAttribute("data-day"),e.options.selectedMonth=parseInt(e.options.currentMonth),e.options.selectedYear=e.options.currentYear,e.options.selectedDayContainer.className+=" dt-selected",e.selectedDayToString(),e.options.onChange&&e.options.onChange(this.options.container),e.options.closeOnSelect&&!e.useTime()&&e.remove()},jsDatePicker.prototype.isNumeric=function(t){return!isNaN(parseFloat(t))&&isFinite(t)},jsDatePicker.prototype.clickOnHour=function(t){var e=this,n=null;n=e.options.dtHourContainer.querySelectorAll(".dt-hour-selected");for(var o=0;o<n.length;o++)n[o].className=n[o].className.replace(" dt-hour-selected","");e.options.selectedHourContainer=t,e.options.selectedHourContainer.className+=" dt-hour-selected",e.options.currentHour=e.options.selectedHourContainer.getAttribute("data-value").split(":")[0],e.options.currentMinutes=e.options.selectedHourContainer.getAttribute("data-value").split(":")[1],e.options.selectedHour=e.options.selectedHourContainer.getAttribute("data-value"),e.selectedDayToString(),e.options.onChange&&e.options.onChange(this.options.container),e.options.closeOnSelect&&e.remove()},jsDatePicker.prototype.bindTime=function(){for(var t=this,e=t.options.dtTableBodyContainer.querySelectorAll(".dt-hour"),n=function(e){e.preventDefault(),t.clickOnHour(this)},o=0;o<e.length;o++)e[o].addEventListener("click",n,!1)},jsDatePicker.prototype.selectedDayToString=function(){var t=this,e="",n="",o="",i="";return t.getSelectedDayContainer()&&t.getSelectedDayContainer().getAttribute?(e=parseInt(t.getSelectedDayContainer().getAttribute("data-day")),n=t.options.selectedMonth+1,o=t.getSelectedYear()):(e=t.getSelectedDay()||t.options.currentDate.getDate(),n=t.getSelectedMonth()?t.getSelectedMonth()+1:t.options.currentMonth,o=t.getSelectedYear()||t.options.currentYear),parseInt(e)<10&&(e="0"+e),10>n&&(n="0"+n),i=e+"/"+n+"/"+o,t.useTime()&&(i+=" - "+t.options.selectedHour),t.options.isInput&&(t.options.container.value=i),i},jsDatePicker.prototype.bindInput=function(){var t=this;t.options.container.addEventListener("focus",function(){t.options.isShow=!0,t.prepareInputValue(this.value),t.generateStructure()},!1),t.options.container.addEventListener("blur",function(){}),t.options.container.addEventListener("keyup",function(){var e=t.options.container.value;t.prepareInputValue(e)&&(t.options.dtContainer?(t.generateDayHTML(),t.useTime()&&t.setTimeSelected()):t.generateStructure())}),document.addEventListener("mousedown",function(e){var n=e.target;for(t.options.clickOnDiv=!1;n&&!t.options.clickOnDiv;)n.id!==t.options.dtContainerId&&n!==t.options.container||(t.options.clickOnDiv=!0),n=n.parentNode;!t.options.clickOnDiv&&t.options.isShow&&t.remove()})},jsDatePicker.prototype.prepareInputValue=function(t){var e=this,n=t.split(" - "),o=n[0].split("/"),i=!1,r=!1;if(o.length>0&&(o[0]&&!isNaN(o[0])&&(e.options.selectedDay="00"!==o[0]?o[0]:(new Date).getDate(),i=!0),o[1]&&o[1]>0&&o[1]<=12&&!isNaN(o[1])&&("00"===o[1]&&(o[1]=(new Date).getMonth(),r=!0),e.options.selectedMonth=o[1]-1,e.options.currentMonth=parseInt(o[1])-1,i=!0),o[2]&&!isNaN(o[2]))){if("0000"===o[2]){var s=(new Date).getFullYear();o[2]=s,r=!0}e.options.selectedYear=o[2],e.options.currentYear=o[2],i=!0}if(e.useTime()===!0){if(n[1]){var a=n[1].split(":");e.options.currentHour=a[0],parseInt(e.options.currentHour)>23&&(e.options.currentHour=23),parseInt(e.options.currentHour)<0&&(e.options.currentHour=0),e.options.currentMinutes=a[1],parseInt(e.options.currentMinutes)>59&&(e.options.currentMinutes=59),parseInt(e.options.currentMinutes)<0&&(e.options.currentMinutes=0),i=!0}if(isNaN(e.options.currentHour)||isNaN(e.options.currentMinutes)){var l=new Date;e.options.currentHour=l.getHours(),e.options.currentMinutes=l.getMinutes(),i=!0}e.options.selectedHour=e.options.currentHour+":"+e.options.currentMinutes}return r&&(e.options.container.value=e.selectedDayToString()),i},jsDatePicker.prototype.isDisabledItem=function(t,e){var n=this,o=!1;if(t&&n.options.disabledItems.days&&(o=n.isDisabledDay(t)),!o&&n.options.disabledItems.dates&&e){var i=e+"/"+(n.getCurrentMonth()+1<10?"0":"")+(n.getCurrentMonth()+1)+"/"+n.getCurrentYear();o=n.isDisabledDate(i)}return o},jsDatePicker.prototype.isDisabledDay=function(t){var e=this;if(e.options.disabledItems.days.length>0){if(t=parseInt(t),0===t&&e.options.disabledItems.days.indexOf("sunday")>=0)return!0;if(1===t&&e.options.disabledItems.days.indexOf("monday")>=0)return!0;if(2===t&&e.options.disabledItems.days.indexOf("tuesday")>=0)return!0;if(3===t&&e.options.disabledItems.days.indexOf("wednesday")>=0)return!0;if(4===t&&e.options.disabledItems.days.indexOf("thursday")>=0)return!0;if(5===t&&e.options.disabledItems.days.indexOf("friday")>=0)return!0;if(6===t&&e.options.disabledItems.days.indexOf("saturday")>=0)return!0}return!1},jsDatePicker.prototype.isDisabledDate=function(t){var e=this;return e.options.disabledItems.dates.indexOf(t)>=0},jsDatePicker.prototype.remove=function(){var t=this;t.options.isShow=!1,t.options.dtContainer.remove(),t.options.dtContainer=null};